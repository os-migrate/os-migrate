- name: Independent tests
  hosts: migrator
  tasks:
    - ansible.builtin.import_tasks: tenant/independent/all.yml
  tags:
    - test_independent

- name: Migration tests
  hosts: migrator
  tasks:
    - ansible.builtin.import_tasks: global/prep.yml
    - args:
        apply:
          tags: test_clean_before
      tags: always
      ansible.builtin.include_tasks: tenant/clean/all.yml
    - ansible.builtin.import_tasks: tenant/seed/all.yml
    - ansible.builtin.import_tasks: tenant/run/all.yml
    - ansible.builtin.import_tasks: tenant/idempotence/all.yml
    - ansible.builtin.import_tasks: tenant/update/all.yml
    - args:
        apply:
          tags: test_clean_after
      tags: always
      ansible.builtin.include_tasks: tenant/clean/all.yml
  tags:
    - test_migration
