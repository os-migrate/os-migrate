<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Variables Guide &mdash; os-migrate  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Migration Parameters Guide" href="migration-params-guide.html" />
    <link rel="prev" title="General usage notes" href="usage-notes.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> os-migrate
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="README.html">OS Migrate User Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="install-from-galaxy.html">Installation from Galaxy (recommended)</a></li>
<li class="toctree-l2"><a class="reference internal" href="install-from-source.html">Installation from source (when customizing)</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade.html">Upgrading</a></li>
<li class="toctree-l2"><a class="reference internal" href="walkthrough.html">OS Migrate Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage-notes.html">General usage notes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Variables Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general-variables">General variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#resource-filters">Resource filters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#conversion-host-variables">Conversion host variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#conversion-host-name">Conversion host name</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-host-image-name">Conversion host image name</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-host-flavor-name">Conversion host flavor name</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-host-external-network-name">Conversion host external network name</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-conversion-host-dependency-names">Other conversion host dependency names</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-host-availablility-zone-management">Conversion host availablility zone management</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-host-network-management">Conversion host network management</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-host-floating-ip-management">Conversion host floating IP management</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-host-specific-floating-ip">Conversion host specific floating IP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#attaching-conversion-hosts-onto-public-networks">Attaching conversion hosts onto public networks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#storage-migration-modes">Storage migration modes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-host-boot-from-volume">Conversion host boot from volume</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-host-rhel-variables">Conversion host RHEL variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#enabling-password-based-ssh-access-to-the-conversion-hosts">Enabling password-based SSH access to the conversion hosts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-custom-bash-scripts-in-the-conversion-hosts">Running custom bash scripts in the conversion hosts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#disabling-the-subscription-manager-tasks">Disabling the subscription manager tasks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#openstack-rest-api-tls-variables">OpenStack REST API TLS variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#workload-import-export-variables">Workload import/export variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="migration-params-guide.html">Migration Parameters Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-it-works-workload-migration.html">How it works: Workload migration</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../roles.html">Documented roles in os-migrate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Documented modules in os-migrate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devel/README.html">OS Migrate Developer Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">os-migrate</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="README.html">OS Migrate User Documentation</a> &raquo;</li>
      <li>Variables Guide</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user/variables-guide.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="variables-guide">
<h1>Variables Guide<a class="headerlink" href="#variables-guide" title="Permalink to this heading"></a></h1>
<p>The goal of this document is to guide users to correctly configure the
most important variables in OS Migrate. For a complete listing of
variables configurable for each Ansible role, refer to the
documentation of the individual roles.</p>
<section id="general-variables">
<h2>General variables<a class="headerlink" href="#general-variables" title="Permalink to this heading"></a></h2>
<section id="resource-filters">
<h3>Resource filters<a class="headerlink" href="#resource-filters" title="Permalink to this heading"></a></h3>
<p>Resource filters allow the user to control which resources will be
migrated. The filters match against resource <strong>names</strong>.</p>
<p>The filters work <strong>both during export and during import</strong>, and it is
not required that the same value is used during export and
import. This feature can be used e.g. to export a subset of the
existing resources, and then during import further limit the subset of
resources being imported into batches.</p>
<p>The value of a filter variable is a list, where each item can be a
string (exact match) or a dictionary with <code class="docutils literal notranslate"><span class="pre">regex</span></code> key (regular
expression match). A resource is exported if it matches at least one
of the list items.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">os_migrate_networks_filter</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_net</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">other_net</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">regex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^myprefix_.*</span>
</pre></div>
</div>
<p>The above example says: Export only networks named <code class="docutils literal notranslate"><span class="pre">my_net</span></code> <strong>or</strong>
<code class="docutils literal notranslate"><span class="pre">other_net</span></code> <strong>or</strong> starting with <code class="docutils literal notranslate"><span class="pre">myprefix_</span></code>.</p>
<p>The filters default to:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">regex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.*</span>
</pre></div>
</div>
<p>meaning “export all resources”. (The set of resources exported will
still be limited to those you can see with the authentication
variables you used.)</p>
<p>Sometimes two roles use the same variable where this makes sense,
especially for attached resources. E.g. roles
<code class="docutils literal notranslate"><span class="pre">export_security_groups</span></code> and <code class="docutils literal notranslate"><span class="pre">export_security_group_rules</span></code> both
use <code class="docutils literal notranslate"><span class="pre">os_migrate_security_groups_filter</span></code>. Similarly,
<code class="docutils literal notranslate"><span class="pre">export_routers</span></code> and <code class="docutils literal notranslate"><span class="pre">export_router_interfaces</span></code> both use
<code class="docutils literal notranslate"><span class="pre">os_migrate_routers_filter</span></code>.</p>
<p>List of the currently implemented filters with default values you can
copy into your variables file and customize:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">os_migrate_flavors_filter</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">regex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.*</span>
<span class="nt">os_migrate_images_filter</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">regex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.*</span>
<span class="nt">os_migrate_keypairs_filter</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">regex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.*</span>
<span class="nt">os_migrate_networks_filter</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">regex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.*</span>
<span class="nt">os_migrate_projects_filter</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">regex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.*</span>
<span class="nt">os_migrate_routers_filter</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">regex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.*</span>
<span class="nt">os_migrate_security_groups_filter</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">regex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.*</span>
<span class="nt">os_migrate_subnets_filter</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">regex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.*</span>
<span class="nt">os_migrate_users_filter</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">regex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.*</span>
<span class="nt">os_migrate_workloads_filter</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">regex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.*</span>
</pre></div>
</div>
</section>
</section>
<section id="conversion-host-variables">
<h2>Conversion host variables<a class="headerlink" href="#conversion-host-variables" title="Permalink to this heading"></a></h2>
<p>The following variables are those that need to be configured prior to
running OS Migrate.</p>
<section id="conversion-host-name">
<h3>Conversion host name<a class="headerlink" href="#conversion-host-name" title="Permalink to this heading"></a></h3>
<p>The conversion hosts might be configured using different names,
this is in case an operator needs to have them registered
with the subscription manager and avoid collisions with the names.</p>
<p>The conversion hosts names can be customized using the
following variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_host_name</span>
<span class="n">os_migrate_dst_conversion_host_name</span>
</pre></div>
</div>
<p>By default, these variables have the same value
for both conversion hosts <cite>os_migrate_conv_src</cite>
and <cite>os_migrate_conv_dst</cite> respectively.</p>
</section>
<section id="conversion-host-image-name">
<h3>Conversion host image name<a class="headerlink" href="#conversion-host-image-name" title="Permalink to this heading"></a></h3>
<p>The conversion host image is the guest configure to execute the
instances migrations.</p>
<p>The variables to be configured are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_image_name</span>
<span class="n">os_migrate_dst_conversion_image_name</span>
</pre></div>
</div>
<p>This image must be accessible to both tenants/projects prior to
executing the conversion host deployment playbook. The variables
default to <code class="docutils literal notranslate"><span class="pre">os_migrate_conv</span></code>, so if a conversion host image is
uploaded to Glance as public image with this name (in both src and dst
clouds), these variables do not need to be configured explicitly.</p>
<p>Make sure this image exists in Glance on both clouds.  Currently it
should be a
<a class="reference external" href="https://cloud.centos.org/centos/9-stream/x86_64/images/CentOS-Stream-GenericCloud-9-20220914.0.x86_64.qcow2">CentOS 9 Cloud Image</a>
or
<a class="reference external" href="https://access.redhat.com/downloads/content/479/ver=/rhel---8/8.3/x86_64/product-software">RHEL 8 KVM Guest Image</a>.</p>
</section>
<section id="conversion-host-flavor-name">
<h3>Conversion host flavor name<a class="headerlink" href="#conversion-host-flavor-name" title="Permalink to this heading"></a></h3>
<p>The conversion host flavor defines the compute, memory, and storage
capacity that will be allocated for the conversion hosts. It needs to
have at least a volume with 20GB.</p>
<p>The variables to be configured are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_flavor_name</span>
<span class="n">os_migrate_dst_conversion_flavor_name</span>
</pre></div>
</div>
<p>Usually, ‘m1.medium’ will suffice this requirement, but again, it can
be different between deployments.</p>
</section>
<section id="conversion-host-external-network-name">
<h3>Conversion host external network name<a class="headerlink" href="#conversion-host-external-network-name" title="Permalink to this heading"></a></h3>
<p>The external network configuration allows the connection of the
conversion host router for external access, this external network must
be able to allocate floating IPs reachable between both conversion
hosts.</p>
<p>Set the name of the external (public) network to which conversion host
private subnet will be attached via its router, for source and
destination clouds respectively, via these variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_external_network_name</span>
<span class="n">os_migrate_dst_conversion_external_network_name</span>
</pre></div>
</div>
<p>This is not required if you are attaching your conversion host to
pre-existing network (when
<cite>os_migrate_src/dst_conversion_manage_network</cite> is <cite>false</cite>).</p>
</section>
<section id="other-conversion-host-dependency-names">
<h3>Other conversion host dependency names<a class="headerlink" href="#other-conversion-host-dependency-names" title="Permalink to this heading"></a></h3>
<p>In addition to the name variables described above, it is possible to
customize names of other conversion host dependency resources:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_net_name</span>
<span class="n">os_migrate_dst_conversion_net_name</span>
<span class="n">os_migrate_src_conversion_subnet_name</span>
<span class="n">os_migrate_dst_conversion_subnet_name</span>
<span class="n">os_migrate_src_conversion_router_name</span>
<span class="n">os_migrate_dst_conversion_router_name</span>
<span class="n">os_migrate_src_conversion_secgroup_name</span>
<span class="n">os_migrate_dst_conversion_secgroup_name</span>
<span class="n">os_migrate_src_conversion_keypair_name</span>
<span class="n">os_migrate_dst_conversion_keypair_name</span>
</pre></div>
</div>
</section>
<section id="conversion-host-availablility-zone-management">
<h3>Conversion host availablility zone management<a class="headerlink" href="#conversion-host-availablility-zone-management" title="Permalink to this heading"></a></h3>
<p>Availability zones are defined by attaching specific metadata
information to an aggregate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_availability_zone</span>
<span class="n">os_migrate_dst_conversion_availability_zone</span>
</pre></div>
</div>
<p>The conversion host can set logical abstractions for partitioning
instances to a specific set of hosts belonging to an aggregate.</p>
<p>The default is <cite>false</cite> (meaning no specification provided).</p>
</section>
<section id="conversion-host-network-management">
<h3>Conversion host network management<a class="headerlink" href="#conversion-host-network-management" title="Permalink to this heading"></a></h3>
<p>It is possible to disable creation and deletion of conversion host
private network by setting these variables to <cite>false</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_manage_network</span>
<span class="n">os_migrate_dst_conversion_manage_network</span>
</pre></div>
</div>
<p>This disables creation of the network, the subnet, and the router that
typically makes the conversion host reachable from outside the cloud.</p>
<p>When disabling network management like this, you’ll need pre-existing
network that the conversion host can attach to and use it to talk to
the other conversion host. Set these network name variables
accordingly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_net_name</span>
<span class="n">os_migrate_dst_conversion_net_name</span>
</pre></div>
</div>
</section>
<section id="conversion-host-floating-ip-management">
<h3>Conversion host floating IP management<a class="headerlink" href="#conversion-host-floating-ip-management" title="Permalink to this heading"></a></h3>
<p>OS Migrate can be told to not attempt to create any floating IPs on
the conversion hosts. This can be useful when attaching a conversion
host to some public network, where its IP address will be
automatically reachable from outside. The variables to control whether
conversion hosts should have floating IPs are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_manage_fip</span>
<span class="n">os_migrate_dst_conversion_manage_fip</span>
</pre></div>
</div>
<p>When the conversion hosts are removed, the required and
assigned floating IPs need to be detached or removed.</p>
<p>The following variables allow to change the behavior
of deleting of detaching the floating IP when deleting the conversion
hosts (default: true):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_host_delete_fip</span>
<span class="n">os_migrate_dst_conversion_host_delete_fip</span>
</pre></div>
</div>
<p>When the corresponding <cite>…_manage_fip</cite> variable is set to <cite>false</cite>,
floating IP deletion is not attempted even if <cite>…_delete_fip</cite> is set
to <cite>true</cite>.</p>
</section>
<section id="conversion-host-specific-floating-ip">
<h3>Conversion host specific floating IP<a class="headerlink" href="#conversion-host-specific-floating-ip" title="Permalink to this heading"></a></h3>
<p>Each conversion host needs to have a floating IP,
these floating IPs can be assigned automatically or
defined by the operator with the usage of the
following variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_floating_ip_address</span>
<span class="n">os_migrate_dst_conversion_floating_ip_address</span>
</pre></div>
</div>
<p>When using this variable to specify an exact IP address, the floating
IP must already exist and be available for attaching.</p>
</section>
<section id="attaching-conversion-hosts-onto-public-networks">
<h3>Attaching conversion hosts onto public networks<a class="headerlink" href="#attaching-conversion-hosts-onto-public-networks" title="Permalink to this heading"></a></h3>
<p>A combination of variables described earlier can be used to attach the
conversion hosts directly onto pre-existing public networks. We need
to make sure that we don’t try to create any private network, we don’t
try to create a floating IP, and we set the conversion host network
names accordingly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_manage_network</span><span class="p">:</span> <span class="n">false</span>
<span class="n">os_migrate_dst_conversion_manage_network</span><span class="p">:</span> <span class="n">false</span>
<span class="n">os_migrate_src_conversion_manage_fip</span><span class="p">:</span> <span class="n">false</span>
<span class="n">os_migrate_dst_conversion_manage_fip</span><span class="p">:</span> <span class="n">false</span>
<span class="n">os_migrate_src_conversion_net_name</span><span class="p">:</span> <span class="n">some_public_net_src</span>
<span class="n">os_migrate_dst_conversion_net_name</span><span class="p">:</span> <span class="n">some_public_net_dst</span>
</pre></div>
</div>
</section>
<section id="storage-migration-modes">
<h3>Storage migration modes<a class="headerlink" href="#storage-migration-modes" title="Permalink to this heading"></a></h3>
<p>The modes for workload migrations can be changed in either
cloud. The variable that control the behavior are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_workloads_data_copy</span>
</pre></div>
</div>
<p>The default is <cite>true</cite> (meaning the copying of data using
os-migrate is skipped).</p>
<p>This is useful if there are pre-created volumes in the
destination cloud that we just want to attach when creating
the VM in the destination.</p>
</section>
<section id="conversion-host-boot-from-volume">
<h3>Conversion host boot from volume<a class="headerlink" href="#conversion-host-boot-from-volume" title="Permalink to this heading"></a></h3>
<p>The conversion hosts can be created as boot-from-volume servers in
either cloud. The variables that control the behavior are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_host_boot_from_volume</span>
<span class="n">os_migrate_dst_conversion_host_boot_from_volume</span>
</pre></div>
</div>
<p>The default is <cite>false</cite> (meaning boot from Nova local disk).</p>
<p>When creating boot-from-volume conversion hosts, it is possible to
customize the size in GB for the boot volume:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_host_volume_size</span>
<span class="n">os_migrate_dst_conversion_host_volume_size</span>
</pre></div>
</div>
<p>The size should be 20 or more, the default is 20.</p>
</section>
<section id="conversion-host-rhel-variables">
<h3>Conversion host RHEL variables<a class="headerlink" href="#conversion-host-rhel-variables" title="Permalink to this heading"></a></h3>
<p>When using RHEL as conversion host, set the SSH user name as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_conversion_host_ssh_user</span><span class="p">:</span> <span class="n">cloud</span><span class="o">-</span><span class="n">user</span>
</pre></div>
</div>
<p>It is also necessary to set RHEL registration variables. The
variables part of this role are set to <code class="docutils literal notranslate"><span class="pre">omit</span></code> by default.</p>
<p>The variables <cite>os_migrate_conversion_rhsm_auto_attach</cite>
and <cite>os_migrate_conversion_rhsm_activationkey</cite> are mutually
exclusive, given that, they are both defaulted to omit.</p>
<p>Typically the only registration variables to set are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_conversion_rhsm_username</span>
<span class="n">os_migrate_conversion_rhsm_password</span>
</pre></div>
</div>
<p>In this case, <cite>os_migrate_conversion_rhsm_auto_attach</cite> should be set to <cite>True</cite>
in order to fetch automatically the content once the node is registered.</p>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_conversion_rhsm_activationkey</span>
<span class="n">os_migrate_conversion_rhsm_org_id</span>
</pre></div>
</div>
<p>For this case, <cite>os_migrate_conversion_rhsm_auto_attach</cite> must be left
undefined with its default value of <cite>omit</cite>.</p>
<p>The complete list of registration variables corresponds to the
<a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/community/general/redhat_subscription_module.html">redhat_subscription</a>
Ansible module. In OS Migrate they are named as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_conversion_rhsm_activationkey</span>
<span class="n">os_migrate_conversion_rhsm_auto_attach</span>
<span class="n">os_migrate_conversion_rhsm_consumer_id</span>
<span class="n">os_migrate_conversion_rhsm_consumer_name</span>
<span class="n">os_migrate_conversion_rhsm_consumer_type</span>
<span class="n">os_migrate_conversion_rhsm_environment</span>
<span class="n">os_migrate_conversion_rhsm_force_register</span>
<span class="n">os_migrate_conversion_rhsm_org_id</span>
<span class="n">os_migrate_conversion_rhsm_password</span>
<span class="n">os_migrate_conversion_rhsm_pool</span>
<span class="n">os_migrate_conversion_rhsm_pool_ids</span>
<span class="n">os_migrate_conversion_rhsm_release</span>
<span class="n">os_migrate_conversion_rhsm_rhsm_baseurl</span>
<span class="n">os_migrate_conversion_rhsm_rhsm_repo_ca_cert</span>
<span class="n">os_migrate_conversion_rhsm_server_hostname</span>
<span class="n">os_migrate_conversion_rhsm_server_insecure</span>
<span class="n">os_migrate_conversion_rhsm_server_proxy_hostname</span>
<span class="n">os_migrate_conversion_rhsm_server_proxy_password</span>
<span class="n">os_migrate_conversion_rhsm_server_proxy_port</span>
<span class="n">os_migrate_conversion_rhsm_server_proxy_user</span>
<span class="n">os_migrate_conversion_rhsm_syspurpose</span>
<span class="n">os_migrate_conversion_rhsm_username</span>
</pre></div>
</div>
<p>Additionally is possible to enable specific repositories in the
conversion hosts using the following variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_conversion_rhsm_repositories</span>
</pre></div>
</div>
<p>The <cite>os_migrate_conversion_rhsm_repositories</cite> variable is a
list of those repositories that will be enabled on the conversion
host.</p>
</section>
<section id="enabling-password-based-ssh-access-to-the-conversion-hosts">
<h3>Enabling password-based SSH access to the conversion hosts<a class="headerlink" href="#enabling-password-based-ssh-access-to-the-conversion-hosts" title="Permalink to this heading"></a></h3>
<p>When required, a user can configure password-based SSH access to
the conversion hosts, this feature might be useful for debugging
when the private key of the hosts is not available anymore.</p>
<p>The variables required in order to configure the password-based
access are named as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_conversion_host_ssh_user_enable_password_access</span>
<span class="n">os_migrate_conversion_host_ssh_user_password</span>
</pre></div>
</div>
<p>The variable <cite>os_migrate_conversion_host_ssh_user_enable_password_access</cite>
is set by default to <cite>false</cite>, and the variable
<cite>os_migrate_conversion_host_ssh_user_password</cite> is set by default to the
following string <cite>weak_password_disabled_by_default</cite>.</p>
<p>The user enabled to access the conversion hosts with password-based authentication
is the one defined in the <cite>os_migrate_conversion_host_ssh_user</cite> variable.</p>
</section>
<section id="running-custom-bash-scripts-in-the-conversion-hosts">
<h3>Running custom bash scripts in the conversion hosts<a class="headerlink" href="#running-custom-bash-scripts-in-the-conversion-hosts" title="Permalink to this heading"></a></h3>
<p>It is possible to run custom bash scripts in the conversion
hosts before and after configuring their content.
The content of the conversion hosts is a set of required packages
and in the case of using RHEL then the configuration of the
subscription manager.</p>
<p>The variables allowing to run the custom scripts are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_host_pre_content_hook</span>
<span class="n">os_migrate_src_conversion_host_post_content_hook</span>
<span class="n">os_migrate_dst_conversion_host_pre_content_hook</span>
<span class="n">os_migrate_dst_conversion_host_post_content_hook</span>
</pre></div>
</div>
<p>The Ansible module used to achieve this is shell,
so users can execute a simple one-liner command, or more
complex scripts like the following examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_host_pre_content_hook</span><span class="p">:</span> <span class="o">|</span>
  <span class="n">ls</span> <span class="o">-</span><span class="n">ltah</span>
  <span class="n">echo</span> <span class="s2">&quot;hello world&quot;</span>
  <span class="n">df</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_src_conversion_host_pre_content_hook</span><span class="p">:</span> <span class="s2">&quot;echo &#39;this is a simple command&#39;&quot;</span>
</pre></div>
</div>
</section>
<section id="disabling-the-subscription-manager-tasks">
<h3>Disabling the subscription manager tasks<a class="headerlink" href="#disabling-the-subscription-manager-tasks" title="Permalink to this heading"></a></h3>
<p>It is possible to disable the subscription manager
native tasks by setting to false the following variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os_migrate_conversion_rhsm_manage</span>
</pre></div>
</div>
<p>This will skip the tasks related to RHSM when using RHEL
in the conversion hosts. Disabling RHSM can be useful in
those cases where the operator has custom scripts they
need to use instead the standard Ansible module.</p>
</section>
</section>
<section id="openstack-rest-api-tls-variables">
<h2>OpenStack REST API TLS variables<a class="headerlink" href="#openstack-rest-api-tls-variables" title="Permalink to this heading"></a></h2>
<p>If either of your clouds uses TLS endpoints that are not trusted by
the Migrator host by default (e.g. using self-signed certificates), or
if the Migrator host should authenticate itself via key+cert, you will
need to set TLS-related variables.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">os_migrate_src_validate_certs</span></code> / <code class="docutils literal notranslate"><span class="pre">os_migrate_dst_validate_certs</span></code> -
Setting these to <code class="docutils literal notranslate"><span class="pre">false</span></code> disables certificate validity checks of
the source/destination API endpoints.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">os_migrate_src_ca_cert</span></code> / <code class="docutils literal notranslate"><span class="pre">os_migrate_dst_ca_cert</span></code> - These
variables allow you to specify a custom CA certificate that should
be used to validate the source/destination API certificates.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">os_migrate_src_client_cert</span></code>, <code class="docutils literal notranslate"><span class="pre">os_migrate_src_client_key</span></code> /
<code class="docutils literal notranslate"><span class="pre">os_migrate_dst_client_cert</span></code>, <code class="docutils literal notranslate"><span class="pre">os_migrate_dst_client_key</span></code> - If the
Migrator host should authenticate itself using a TLS key +
certificate when talking to source/destination APIs, set these
variables.</p></li>
</ul>
</section>
<section id="workload-import-export-variables">
<h2>Workload import/export variables<a class="headerlink" href="#workload-import-export-variables" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">os_migrate_workload_stop_before_migration</span></code> - Set to true if you wish
for os_migrate to stop your workloads/vms prior to migration. Note that
only workloads/vms in <cite>SHUTOFF</cite> state will be migrated.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="usage-notes.html" class="btn btn-neutral float-left" title="General usage notes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="migration-params-guide.html" class="btn btn-neutral float-right" title="Migration Parameters Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, os-migrate.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>